`classifyFaces` 函数的核心是一个**区域传播算法（Region Growing / BFS）**，它的目的是从边界三角形出发，逐步向外扩展，标记出所有“外部”三角形。我们可以用一个**地图探索的比喻**来形象理解整个遍历过程。

---

## 🧭 比喻：你是一个探险者，在迷宫中寻找出口

### 地图结构：
- 整个三角剖分网格就像一座由多个房间组成的迷宫。
- 每个三角形是一个房间。
- 两个相邻三角形之间有一扇门（共享一条边）。
- 有些门是锁着的（约束边），有些门是开着的。
- 边界三角形就是那些靠外墙的房间，它们只有一面墙有门。

### 初始状态：
- 你站在几个靠外墙的房间（即 `faceIndex.active` 中的初始三角形）。
- 你的任务是找出哪些房间在“外面”，也就是属于“外部区域”。

---

## 🚶‍♂️ 遍历过程详解（类比探索）

### 第一步：你开始探索
- 你从第一个房间（active 中取出的三角形）开始。
- 给这个房间贴上标签：“我是外部区域的一部分”（设置 `flags[i] = side`）。

### 第二步：打开门，看看能去哪
- 对于当前房间的每一道门（每条边）：
  - 如果这道门通向另一个房间（邻接三角形存在）：
    - 如果那个房间还没被贴过标签：
      - 如果门是锁着的（约束边） → 把它记下来，稍后再处理（放入 `next`）。
      - 如果门是开着的（非约束边） → 立刻进去探索（放入 `active` 并贴标签）。

### 第三步：一轮探索结束，换一批继续
- 当前这一轮的房间都探索完了（`active` 空了）。
- 把下一批要探索的房间（`next`）换成当前队列，准备下一轮探索。
- 同时反转方向（`side = -side`），表示这次探索的是“内部”区域。

> 🔁 这样不断交替探索内外区域，直到整个迷宫都被探索完毕。

---

## 🎯 最终目标：找出所有“外部”房间

- 所有被标记为 `flags[i] = -1` 的三角形（房间）就是你要找的“外部区域”。
- 使用 `filterCells(faceIndex.cells, faceIndex.flags, -1)` 就可以提取这些三角形。

---

## 📌 总结：用一句话概括

> **`classifyFaces` 就像一个探险者从边界出发，通过一扇扇门不断探索相邻房间，给它们贴上“外部”或“内部”标签，最终找出所有属于外部区域的三角形。**

---

如果你把整个三角剖分想象成一张地图，那么这段代码就是在做“地图标注”和“区域划分”的工作，非常像游戏中的“视野探索”或“区域染色”逻辑。